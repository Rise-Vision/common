var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Utilities=function(){function e(e,t){var i="font-family: "+decodeURIComponent(t.font.family).replace(/'/g,"")+"; ",n="color: "+(t.color?t.color:t.forecolor)+"; ",o="font-size: "+(-1===t.size.indexOf("px")?t.size+"px; ":t.size+"; "),s="font-weight: "+(t.bold?"bold":"normal")+"; ",a="font-style: "+(t.italic?"italic":"normal")+"; ",r="text-decoration: "+(t.underline?"underline":"none")+"; ",l="background-color: "+(t.highlightColor?t.highlightColor:t.backcolor)+";";return"."+e+" {"+i+n+o+s+a+r+l+"}"}function t(e){for(var t=document.createElement("style"),i=0,n=e.length;n>i;i++)t.appendChild(document.createTextNode(e[i]));document.head.appendChild(t)}function i(i,s){function a(){s&&"function"==typeof s&&s()}function r(){a()}var l=null,c=[],u=[],d=[];if(!i||0===i.length)return a(),void 0;i.forEach(function(i){i.class&&i.fontStyle&&t([e(i.class,i.fontStyle)])});for(var m=0;m<i.length;m++)i[m].fontStyle&&i[m].fontStyle.font.type&&"google"===i[m].fontStyle.font.type&&(l=i[m].fontStyle.font.family.split(",")[0],l=l.replace(/'/g,""),c.push(l));for(m=0;m<i.length;m++)i[m].fontStyle&&i[m].fontStyle.font.type&&"custom"===i[m].fontStyle.font.type&&(u.push(decodeURIComponent(i[m].fontStyle.font.family).replace(/'/g,"")),d.push(i[m].fontStyle.font.url.replace(/'/g,"\\'")));if(0===c.length&&0===u.length)a();else{for(var f=0;f<u.length;f+=1)n(u[f],d[f]);c.length>0?o(c,r):a()}}function n(e,t,i){var n=null,o="font-family: "+e+"; src: url('"+t+"');";i=i||document,n=i.styleSheets[0],null!==n&&n.addRule("@font-face",o)}function o(e,t){WebFont.load({google:{families:e},active:function(){t&&"function"==typeof t&&t()},inactive:function(){t&&"function"==typeof t&&t()},timeout:5e3})}function s(e){var t=document.createElement("script");t.src=e,document.body.appendChild(t)}function a(e){for(var t=e.length,i=[],n=0;t>n;n++)i[n]=new Image,i[n].src=e[n]}function r(e){return l(e,window.location.href)}function l(e,t){e=e.replace(/[[]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function c(e){var t=/(\d{4})\.(\d{2})\.(\d{2})\.(\d{2})\.(\d{2})/,i=t.exec(e);return i?new Date(+i[1],+i[2]-1,+i[3],+i[4],+i[5]):void 0}function u(){var e=r("parent"),t=r("type"),i=r("env"),n=r("viewerId"),o=t?t:e?l("type",e):"",s=i?i:e?l("env",e):"",a=n?n:e?l("viewerId",e):"";return{viewer_env:s,viewer_id:a,viewer_type:o}}function d(e){var t="";switch(e){case 404:t="The file does not exist or cannot be accessed.";break;case 507:t="There is not enough disk space to save the file on Rise Cache.";break;default:t="There was a problem retrieving the file from Rise Cache."}return t}function m(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent}function f(e,t){var i=new XMLHttpRequest;if(e&&t&&"function"==typeof t){i.open("HEAD",e+"?cb="+(new Date).getTime(),!1);try{i.send(),t(i.status>=200&&i.status<304)}catch(n){t(!1)}}}function h(){var e=25,t=navigator.userAgent.match(/Chrome\/(\S+)/),i=t?t[1]:0;return i&&(i=parseInt(i.substring(0,i.indexOf("."))),e>=i)?!0:!1}function p(e,t){return/^(?:f|ht)tps?\:\/\//.test(e)||(e=(t?"https://":"http://")+e),e}return{addProtocol:p,getQueryParameter:r,getQueryStringParameter:l,getFontCssStyle:e,addCSSRules:t,loadFonts:i,loadCustomFont:n,loadGoogleFonts:o,loadScript:s,preloadImages:a,getRiseCacheErrorMessage:d,unescapeHTML:m,hasInternetConnection:f,isLegacy:h,getDateObjectFromPlayerVersionString:c,getViewerParams:u}}();var WIDGET_COMMON_CONFIG={AUTH_PATH_URL:"v1/widget/auth",LOGGER_CLIENT_ID:"1088527147109-6q1o2vtihn34292pjt4ckhmhck0rk0o7.apps.googleusercontent.com",LOGGER_CLIENT_SECRET:"nlZyrcPLg6oEwO9f9Wfn29Wh",LOGGER_REFRESH_TOKEN:"1/xzt4kwzE1H7W9VnKB8cAaCx6zb4Es4nKEoqaYHdTD15IgOrJDtdun6zK6XiATCKT",STORE_URL:"https://store-dot-rvaserver2.appspot.com/"},CollectionTimes=function(){function e(){function e(i,n){var o,s=6e4,a=new RiseVision.Common.Visualization,r=setTimeout(function(){e(i,n)},s);o={url:"http://contentfinancial2.appspot.com/info?codes="+i,refreshInterval:0,queryString:"select startTime, endTime, daysOfWeek, timeZoneOffset, updateInterval",callback:function(e,o){a=null,null!==e?(clearTimeout(o),t(i,e),n()):console.log("Error encountered loading collection times for: "+i)},params:r},a.getData(o)}function t(e,t){var n,o,s,a;if(null!==t){n=t.getNumberOfRows();for(var r=0;r<i.length;r++)if(i[r].instrument===e){a=t.getValue(0,3),o=t.getValue(0,0),s=t.getValue(0,1),i[r].collectionTimes={instrument:e,startTime:o.setTimezoneOffset(a),endTime:s.setTimezoneOffset(a),daysOfWeek:t.getFormattedValue(0,2).split(","),timeZoneOffset:a,isUpdated:!0};break}}}return{setIsUpdated:function(e,t){for(var n=0;n<i.length;n++)i[n].instrument===e&&null!==i[n].collectionTimes&&(i[n].collectionTimes.isUpdated=t)},addInstrument:function(t,n,o){for(var s=0,a=!1,r=!1;s<i.length;s++)if(i[s].instrument===t){null!==i[s].collectionTimes&&(Date.equals(Date.today(),n)||i[s].collectionTimes.isUpdated||(n=Date.today(),i[s].collectionTimes.startTime.addDays(1),i[s].collectionTimes.endTime.addDays(1),i[s].collectionTimes.isUpdated=!0),r=!0),a=!0;break}r?o(i[s].collectionTimes,n):(a||i.push({instrument:t,collectionTimes:null}),e(t,function(){o(i[s].collectionTimes,n)}))}}}var t=!1,i=[];return{getInstance:function(){return t||(t=e()),t}}}(),RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Financial=RiseVision.Common.Financial||{},RiseVision.Common.Financial.Helper={},RiseVision.Common.Financial.Helper=function(e){this.instruments=e},RiseVision.Common.Financial.Helper.prototype.setInstruments=function(e){this.instruments=e},RiseVision.Common.Financial.Helper.prototype.getInstruments=function(e,t){var i=this;if(e)return this.instruments.join("|");var n=(new Date).getDay(),o=t.length,s=[];return $.each(this.instruments,function(e,a){for(var r=0;o>r;r++)if(a===t[r].instrument){var l=t[r].startTime,c=t[r].endTime,u=t[r].daysOfWeek;$.each(u,function(t,o){return o==n?((new Date).between(l,c)&&s.push(i.instruments[e]),!1):void 0})}}),s.join("|")};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Financial=RiseVision.Common.Financial||{},RiseVision.Common.Financial.Historical={},RiseVision.Common.Financial.Historical.CollectionTimes={},RiseVision.Common.Financial.Historical=function(e,t,i){this.displayID=e?e:"preview",this.instrument=t,this.duration=i,this.isLoading=!0,this.updateInterval=6e4,this.now=Date.today(),this.url="https://contentfinancial2.appspot.com/data/historical?",this.historicalViz=new RiseVision.Common.Visualization,this.helper=new RiseVision.Common.Financial.Helper([this.instrument])},RiseVision.Common.Financial.Historical.prototype.setInstrument=function(e){this.isLoading=!0,this.instrument=e,this.helper.setInstruments([this.instrument])},RiseVision.Common.Financial.Historical.prototype.setDuration=function(e){this.duration=e},RiseVision.Common.Financial.Historical.prototype.setIsUpdated=function(e){CollectionTimes.getInstance().setIsUpdated(this.instrument,e)},RiseVision.Common.Financial.Historical.prototype.getHistoricalData=function(e,t,i){var n=this,o="select "+e.join()+" ORDER BY tradeTime",s="";i&&(i.sortOrder&&"desc"===i.sortOrder&&(o+=" desc"),i.limit&&(o+=" LIMIT "+i.limit)),CollectionTimes.getInstance().addInstrument(this.instrument,this.now,function(a,r){n.now=r,s=n.helper.getInstruments(n.isLoading,[a]),s?(i={url:n.url+"id="+n.displayID+"&code="+n.instrument+"&kind="+n.duration,refreshInterval:0,queryString:o,callback:function(e){n.onHistoricalDataLoaded(e,a,t)}},n.getHistoricalDataTimer=setTimeout(function(){n.getHistoricalData(e,t,i)},n.updateInterval),n.historicalViz.getData(i)):t(null)})},RiseVision.Common.Financial.Historical.prototype.onHistoricalDataLoaded=function(e,t,i){var n=0;null!==e?(clearTimeout(this.getHistoricalDataTimer),this.historicalData=e,n=e.getNumberOfRows(),this.isLoading=0===n||1===n&&"0"===e.getFormattedValue(0,0)?!0:!1,null!==this.historicalData?i({data:this.historicalData,collectionData:t}):i({collectionData:t})):(console.log("Error encountered loading historical data for: "),console.log(this))};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Financial=RiseVision.Common.Financial||{},RiseVision.Common.Financial.RealTime={},RiseVision.Common.Financial.RealTime=function(e,t,i){this.instruments=t,this.isLoading=!0,this.conditions={},this.collectionTimes=[],this.updateInterval=6e4,this.now=Date.today(),this.url="https://contentfinancial2.appspot.com/data?",this.logosURL="https://s3.amazonaws.com/risecontentlogos/financial/",this.viz=new RiseVision.Common.Visualization,this.helper=new RiseVision.Common.Financial.Helper(this.instruments),this._getDisplayId=function(){return e&&i.isAuthorized()?e:"preview"},this._saveCollectionTimes=function(){var e;if(e=this.data.getNumberOfRows(),1===this.instruments.length&&this.data.getNumberOfRows()>1)this._saveCollectionTime(0);else{for(var t=0;e>t;t++)this._saveCollectionTime(t);0===this.collectionTimes.length&&console.log(this.collectionTimes)}},this._saveCollectionTime=function(e){var t,i,n;"INVALID_SYMBOL"!==this.data.getValue(e,0)&&("..."===this.data.getValue(e,0)?this.isLoading=!0:(t=this.data.getValue(e,this.startTimeIndex+3),i=this.data.getValue(e,this.startTimeIndex),n=this.data.getValue(e,this.startTimeIndex+1),i&&n&&"N/P"!==t&&this.collectionTimes.push({instrument:this.instruments[e],startTime:i.setTimezoneOffset(t),endTime:n.setTimezoneOffset(t),daysOfWeek:this.data.getFormattedValue(e,this.startTimeIndex+2).split(",")})))}},RiseVision.Common.Financial.RealTime.prototype.setInstruments=function(e){e=e.split(","),$.each(e,function(t){e[t]=$.trim(e[t])}),this.isLoading=!0,this.collectionTimes=[],this.instruments=e,this.helper.setInstruments(this.instruments)},RiseVision.Common.Financial.RealTime.prototype.getData=function(e,t,i,n){var o=this,s=!1,a=0,r="select instrument",l="";if(this.dataFields={},this.dataFields.instrument=0,this.startTimeIndex=1,this.isLoading&&(this.callback=n),$.each(e,function(e,t){s=!1,"instrument"!==t&&($.each(o.dataFields,function(e){return e===t?(s=!0,!1):void 0}),s||(r+=", "+t,o.dataFields[t]=a+1,a++,o.startTimeIndex++))}),this.logoCount=0,r+=", startTime, endTime, daysOfWeek, timeZoneOffset",!Date.equals(Date.today(),this.now)){this.now=Date.today();for(var c=0;c<this.collectionTimes.length;c++)this.collectionTimes[c].startTime.addDays(1),this.collectionTimes[c].endTime.addDays(1)}if(l=this.helper.getInstruments(this.isLoading,this.collectionTimes)){var u={url:this.url+"id="+this._getDisplayId()+"&codes="+l,refreshInterval:0,queryString:r,callback:function(e){o.onRealTimeDataLoaded(e,t,i)}};this.getDataTimer=setTimeout(function(){o.getData(e,t,i,n)},this.updateInterval),this.viz.getData(u)}else n(null)},RiseVision.Common.Financial.RealTime.prototype.onRealTimeDataLoaded=function(e,t,i){null!==e?(clearTimeout(this.getDataTimer),this.data=e,this.isLoading?(this.isLoading=!1,0===this.collectionTimes.length&&this._saveCollectionTimes(),t?this.loadLogos():this.callback&&this.callback(this.data,this.logoURLs)):t&&i?this.loadLogos():this.callback&&this.callback(this.data,this.logoURLs)):(console.log("Error encountered loading real-time data for: "),console.log(this.instruments[0]))},RiseVision.Common.Financial.RealTime.prototype.loadLogos=function(){var e=this.data.getNumberOfRows();this.logoCount=0,this.urls=[],this.logoURLs=[];for(var t=0;e>t;t++)this.urls.push(this.logosURL+this.data.getFormattedValue(t,0)+".svg");this.loadLogo(this.urls.length)},RiseVision.Common.Financial.RealTime.prototype.loadLogo=function(e){var t,i=this;t=new Image,t.onload=function(){i.logoURLs.push(t.src),i.onLogoLoaded(e)},t.onerror=function(){i.logoURLs.push(null),i.onLogoLoaded(e)},t.src=this.urls[this.logoCount]},RiseVision.Common.Financial.RealTime.prototype.onLogoLoaded=function(e){this.logoCount++,e--,0===e?this.callback&&this.callback(this.data,this.logoURLs):this.loadLogo(e)},RiseVision.Common.Financial.RealTime.prototype.checkSigns=function(e){var t,i,n=0,o=0,s=[];for(n=0,o=this.data.getNumberOfRows();o>n;n++)t=this.data.getValue(n,this.dataFields[e]),isNaN(t)&&(t=t.replace(/[^0-9\.-]+/g,""),t=parseFloat(t)),isNaN(t)||(i=t>=0?1:-1,s.push(i));return s},RiseVision.Common.Financial.RealTime.prototype.compare=function(e){var t=this,i=0,n=0,o=0,s=0,a=[],r=!1;if(this.conditions[e])for(i=0,n=this.data.getNumberOfRows();n>i;i++)o=this.data.getValue(i,this.dataFields[e]),r=!1,$.each(this.conditions[e],function(e,n){return n.instrument===t.data.getValue(i,0)?(s=n.value,isNaN(o)&&(o=o.replace(/[^0-9\.-]+/g,""),o=parseFloat(o)),isNaN(s)&&(s=s.replace(/[^0-9\.-]+/g,""),s=parseFloat(s)),isNaN(o)||isNaN(s)||(o!=s?o>s?a.push(1):a.push(-1):a.push(0)),r=!0,!1):void 0}),r||a.push(0);return this.saveBeforeValues([e]),a},RiseVision.Common.Financial.RealTime.prototype.saveBeforeValues=function(e){var t=this;$.each(e,function(e,i){t.conditions[i]=[],t.saveBeforeValue(i,t.dataFields[i])})},RiseVision.Common.Financial.RealTime.prototype.saveBeforeValue=function(e,t){for(var i=0,n=this.data.getNumberOfRows();n>i;i++)this.conditions[e].push({instrument:this.data.getValue(i,0),value:this.data.getValue(i,t)})};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(){"use strict";function e(e,n){var s=null;if(e.event){s=e,s.file_url&&(s.file_format=e.file_format||o(s.file_url)),s.company_id=p,s.display_id=h;var a=t("parent"),r=t("type"),l=t("env"),c=t("viewerId"),u=r?r:a?i("type",a):"",d=l?l:a?i("env",a):"",m=c?c:a?i("viewerId",a):"",f=a?i("id",a):"";s.viewer_id=m,"sharedschedule"===u&&(s.presentation_type=u,s.schedule_id=f,s.env=d),g&&(s.version=g),n(s)}else n(s)}function t(e){return i(e,window.location.href)}function i(e,t){e=e.replace(/[[]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=i.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}function n(){var e=new Date,t=e.getUTCFullYear(),i=e.getUTCMonth()+1,n=e.getUTCDate();return 10>i&&(i="0"+i),10>n&&(n="0"+n),""+t+i+n}function o(e){var t,i=/[?#&]/;return e&&"string"==typeof e?(t=e.substr(e.lastIndexOf(".")+1),i.test(t)&&(t=t.substr(0,-1!==t.indexOf("?")?t.indexOf("?"):t.length),t=t.substr(0,-1!==t.indexOf("#")?t.indexOf("#"):t.length),t=t.substr(0,-1!==t.indexOf("&")?t.indexOf("&"):t.length)),t.toLowerCase()):null}function s(e){var t={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,templateSuffix:n(),rows:[{insertId:""}]},i=JSON.parse(JSON.stringify(t));return i.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),i.rows[0].json=JSON.parse(JSON.stringify(e)),i.rows[0].json.ts=(new Date).toISOString(),i}function a(t,i,n){e(i,function(e){null!==e&&RiseVision.Common.Logger.log(t,e)}),l(i,n)}function r(e){if(f()){var t=window.top.RiseVision.Viewer.Logger.heartbeatInterval(),i=window.top.RiseVision.Viewer.Logger.recordUptimeHeartbeat,n=i.bind(null,{eventApp:e,eventAppVersion:g});n(),setInterval(n,t)}}function l(e,t){return t&&m()?e.event_details&&t.severity&&t.eventApp?(window.top.RiseVision.Viewer.Logger.logTemplateEvent({severity:t.severity,eventApp:t.eventApp,eventAppVersion:g,eventDetails:e.event_details||null,eventErrorCode:t.errorCode||null,debugInfo:e.error_details||t.debugInfo||null}),void 0):console.error("invalid endpoint logging attempt"):void 0}function c(e,t){try{top.postToPlayer({message:"widget-log",table:e,params:JSON.stringify(t),suffix:n()})}catch(i){console.log("widget-common.logEventToPlayer",i)}}function u(e,t){p=e,h=t}function d(e){g=e}function m(){var e=!1;try{e=window.top&&window.top.RiseVision&&window.top.RiseVision.Viewer&&window.top.RiseVision.Viewer.Logger&&window.top.RiseVision.Viewer.Logger.logTemplateEvent}catch(t){e=!1,console.debug&&console.debug(t)}return e}function f(){var e=!1;try{e=window.top&&window.top.RiseVision&&window.top.RiseVision.Viewer&&window.top.RiseVision.Viewer.Logger&&window.top.RiseVision.Viewer.Logger.recordUptimeHeartbeat}catch(t){e=!1,console.debug&&console.debug(t)}return e}var h="",p="",g=null;return{getInsertData:s,getFileFormat:o,getQueryParameter:t,getQueryStringParameter:i,logEvent:a,logEventToPlayer:c,startEndpointHeartbeats:r,logEndpointEvent:l,setIds:u,setVersion:d}}(),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-c<358e4?e({}):(t.open("POST",o,!0),t.onloadend=function(){var i={};try{i=JSON.parse(t.response)}catch(n){console.warn("Can't refresh logger token - ",n.message)}e({token:i.access_token,refreshedAt:new Date})},t.send(),void 0)}function i(e){return a&&l===e}function n(n,o){function d(t){var i,a,r=new XMLHttpRequest;a=s.replace("TABLE_ID",n),c=t.refreshedAt||c,u=t.token||u,i=e.getInsertData(o),r.open("POST",a,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Bearer "+u),o.cb&&"function"==typeof o.cb&&(r.onloadend=function(){o.cb(r.response)}),r.send(JSON.stringify(i))}if(!(!n||!o||o.hasOwnProperty("event")&&!o.event||o.hasOwnProperty("event")&&i(o.event))&&(o.presentation_type&&"sharedschedule"===o.presentation_type||o.display_id&&"preview"!==o.display_id&&"display_id"!==o.display_id&&"displayId"!==o.display_id)){try{if(top.postToPlayer&&top.enableWidgetLogging)return e.logEventToPlayer(n,o)}catch(m){console.log("widget-common: logger",m)}return a=!0,l=o.event,setTimeout(function(){a=!1},r),t(d)}}var o="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",s="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",a=!1,r=1e3,l="",c=0,u="";return{log:n}}(RiseVision.Common.LoggerUtils);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Message=function(e,t){"use strict";function i(){try{t.style.height=e.style.height}catch(i){console.warn("Can't initialize Message - ",i.message)}}function n(){if(s){for(;t.firstChild;)t.removeChild(t.firstChild);t.style.display="none",e.style.display="block",s=!1}}function o(i){var n,o=document.createDocumentFragment();s?(n=t.querySelector(".message"),n.innerHTML=i):(e.style.display="none",t.style.display="block",n=document.createElement("p"),n.innerHTML=i,n.setAttribute("class","message"),o.appendChild(n),t.appendChild(o),s=!0)}var s=!1;return i(),{hide:n,show:o}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseCache=function(){"use strict";function e(e){var t=new XMLHttpRequest,i=this;e&&"function"==typeof e&&(d?t.open("GET",l,!0):t.open("GET",l+"ping?callback=_",!0),t.onreadystatechange=function(){try{if(4===t.readyState)if(c=!0,200===t.status){u=!0;try{var n=t.responseText?JSON.parse(t.responseText):"";n&&(p=n.version)}catch(o){console.log(o)}e(!0,t.responseText)}else{if(404===t.status)return d=!0,l="https://localhost:9495/",i.ping(e);if(m)return d=!0,m=!1,l="http://localhost:9494/",i.ping(e);console.debug("Rise Cache is not running"),d=!1,u=!1,e(!1,null)}}catch(o){console.debug("Caught exception: ",o.description)}},t.send())}function t(e,t,i){function n(){var t,n,s;u?t=d?p&&window.compareVersions(p,h)>0?l+"files?url="+e:l+"files?url="+encodeURIComponent(e):i?l+"?url="+encodeURIComponent(e):l+"cb="+(new Date).getTime()+"?url="+encodeURIComponent(e):i?t=e:(n=e.split("?"),s=1===n.length?"?":"&",t=e+s+"cb="+(new Date).getTime()),o("HEAD",t)}function o(e,i){var n=new XMLHttpRequest,a={xhr:n,url:i};u?(n.open(e,i,!0),n.addEventListener("loadend",function(){var r=n.status||0;202===r?(s++,3>s?setTimeout(function(){o(e,i)},3e3):t(a,new Error("File is downloading"))):r>=200&&300>r?t(a):"HEAD"===e?o("GET",i):t(a,new Error("The request failed with status code: "+r))}),n.send()):t(a)}if(e&&t&&"function"==typeof t){var s=0;return c?n():this.ping(n)}}function i(e){var t="";switch(e){case 502:t="There was a problem retrieving the file.";break;case 504:t="Unable to download the file. The server is not responding.";break;case 507:t="There is not enough disk space to save the file on Rise Cache.";break;case 534:t="The file does not exist or cannot be accessed.";break;default:t=""}return t}function n(e){return e&&"function"==typeof e?c?(e(u),void 0):this.ping(function(){e(u)}):void 0}function o(e){return e&&"function"==typeof e?c?(e(d),void 0):this.ping(function(){e(d)}):void 0}function s(e){return e&&"function"==typeof e?this.isV2Running(function(t){t?e(t):e(a())}):void 0}function a(){var e=f.getDateObjectFromPlayerVersionString("2016.10.10.00.00"),t=f.getQueryParameter("sysInfo");if(!t){var i=f.getQueryParameter("parent");t=f.getQueryStringParameter("sysInfo",i)}if(t){var n=f.getQueryStringParameter("pv",t),o=f.getDateObjectFromPlayerVersionString(n);return o>=e}return!1}function r(){c=!1,u=!1,d=!1,m=!0,l="http://localhost:9494/"}var l="http://localhost:9494/",c=!1,u=!1,d=!1,m=!0,f=RiseVision.Common.Utilities,h="1.7.3",p="";return{getErrorMessage:i,getFile:t,isRiseCacheRunning:n,isV2Running:o,isRCV2Player:s,ping:e,reset:r}}();var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseData=function(e,t){"use strict";function i(e,t){var i;return"string"==typeof t&&(i=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t))?new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6])):t}function n(){return"session"===e.storageType}function o(){return"local"===e.storageType}function s(e,t){var s=null;if(o())try{s=JSON.parse(localStorage.getItem(e),i)}catch(a){console.warn(a)}else if(n())try{s=JSON.parse(sessionStorage.getItem(e),i)}catch(a){console.warn(a)}t(s)}function a(t,i){var n=T+"/"+e.endpoint;return("DELETE"===i||"GET"===i)&&(n+="/"+t),n}function r(e){var t=null;V&&"function"==typeof V&&(t=e?e.value:t,null!==t&&"object"==typeof t&&(t=JSON.stringify(t)),t=JSON.parse(t,i),V(t)),V=null}function l(){V&&"function"==typeof V&&s(C,V)}function c(e){$.getJSON(e).done(function(e){r(e)}).fail(function(){l()})}function u(e,t){$.ajax({type:"POST",url:e,contentType:"application/json",data:t,dataType:"json"}).done(function(e){r(e),w.push(R)})}function d(e,t){var i=a(e,"GET");R=e,V=t,C=e,c(i)}function m(e,t){var i=a(e,"POST"),n=JSON.stringify({key:e,value:t});R=e,u(i,n)}function f(){}function h(t,i){v&&t&&i&&"function"==typeof i&&(y?e.endpoint?d(t,i):s(t,i):s(t,i))}function p(e){e&&"function"==typeof e&&t.isRiseCacheRunning(function(t){y=t,v=!0,e()})}function g(t,i){if(v&&t&&i)if(y&&e.endpoint&&m(t,i),o())try{localStorage.setItem(t,JSON.stringify(i))}catch(s){console.warn(s)}else if(n())try{sessionStorage.setItem(t,JSON.stringify(i))}catch(s){console.warn(s)}}var v=!1,y=!1,R=null,V=null,C=null,T="https://localhost:9495",w=[];return{deleteItem:f,getItem:h,init:p,saveItem:g}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.RiseGoogleSheet=function(e,t,i){"use strict";function n(){var t={};return t.key=e.apikey,t.majorDimension=e.dimension,t.valueRenderOption=e.render,t}function o(){return""===e.range?"":"!"+e.range}function s(){return R+e.key+"/values/"+encodeURIComponent(e.sheet)+o()}function a(e){var t=0;return e.forEach(function(e){e.length>t&&(t=e.length)}),t}function r(e){var t,i=0,n=a(e);e.forEach(function(e){if(e.length<n)for(i=n-e.length,t=0;i>t;t++)e.push("")})}function l(e){var t={};return t.results=e.values?e.values:[],r(t.results),t}function c(){var t=parseInt(e.refresh,10);isNaN(t)||0===t||(p(),I=setTimeout(function(){w=!0,y()},6e4*t))}function u(e){var n={status:e.status,statusText:e.statusText};t.getItem(h(),function(e){n=e?Object.assign(n,e.data):n,i("error",n)}),T=!1,c()}function d(e){var n,o={};e&&(n=l(e),o.data=n,o.timestamp=Date.now(),t.saveItem(h(),o),i("response",n)),T=!1,c()}function m(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)}function f(e){var t=s(),i=n(),o=1e3*m(0,e);T=!0,setTimeout(function(){$.getJSON(t,i).done(function(e){d(e)}).fail(function(e){u(e)})},o)}function h(){return V+"_"+e.key+"_"+encodeURIComponent(e.sheet.replace(/\s+/g,"_"))+(""===e.range?"":"_"+e.range)}function p(){clearTimeout(I),I=null}function g(t){var n,o,s,a,r=parseInt(e.refresh,10);w||!t?(w=!1,f(t?180:60)):(i("response",t.data),b&&(b=!1,isNaN(r)||0===r||(n=t.timestamp,isNaN(n)&&(o=new Date(t.timestamp),n=o.getTime()),s=Date.now(),a=Math.ceil((s-n)/1e3/60),a>=r?f(180):(p(),I=setTimeout(function(){f(180)},6e4*(r-a))))))}function v(){C=!0,t.getItem(h(),function(e){g(e)})}function y(){return e.key&&e.apikey&&""!==e.sheet&&!T?C?(t.getItem(h(),function(e){g(e)}),void 0):t.init(v):void 0}var R="https://sheets.googleapis.com/v4/spreadsheets/",V="risesheet",C=!1,T=!1,w=!1,b=!0,I=null;return{go:y}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Scroller=function(e){"use strict";function t(){n(),c(),b>E?(O=!0,V.width=E,i()):V.width=b,n(),c()}function i(){var e=new Event("scroller-oversized-canvas");y.dispatchEvent(e)}function n(){b=0;for(var e=0;e<w.length;e++)w[e].separator?o(w[e]):s(w[e])}function o(e){var t=V.height/2,i=e.size/2;C.save(),C.fillStyle=e.color,C.beginPath(),C.arc(b+i,t,i,0,2*Math.PI),C.fill(),b+=e.size+10,C.restore()}function s(e,t){var i,n={};e&&(n.text=L.unescapeHTML(e.text),e.fontStyle&&(i=e.fontStyle,i.font&&i.font.family&&(n.font=i.font.family),i.size&&(n.size=i.size),i.forecolor&&(n.foreColor=i.forecolor),i.bold&&(n.bold=i.bold),i.italic&&(n.italic=i.italic),i.backcolor&&t&&(n.backcolor=i.backcolor)),t?r(n):a(n))}function a(e){var t="";C.save(),e.bold&&(t="bold "),e.italic&&(t+="italic "),e.size&&(t+=e.size+" "),e.font&&(t+=e.font),C.font=t,C.fillStyle=e.foreColor,C.textBaseline="middle",C.translate(0,V.height/2),C.fillText(e.text,b,0),b+=C.measureText(e.text).width+10,C.restore()}function r(e){var t,i,n="";C.save(),e.bold&&(n="bold "),e.italic&&(n+="italic "),e.size&&(n+=e.size+" "),e.font&&(n+=e.font),C.font=n,C.textBaseline="middle",t=C.measureText("  ...  ").width,i=e.size?e.size.indexOf("px")>0?parseInt(e.size.slice(0,e.size.indexOf("px")),10):e.size:10,C.translate(0,V.height/2),C.fillStyle="transparent"===e.backcolor?"#FFF":e.backcolor,C.fillRect(E-t,-(i/2),t,i),C.fillStyle=e.foreColor,C.fillText("  ...  ",E-t,0),C.restore()}function l(){R.clearRect(0,0,y.width,y.height),R.drawImage(V,R.xpos,0)}function c(){var e=0,t=0,i=0;if(I=O?E:b,w.length>0){for(;e<y.width;)w[i].separator?o(w[i]):s(w[i]),e=b-I,t=i,i=t===w.length-1?0:t+1;O&&s(w[t],!0)}}function u(){var t;if(e.transition&&e.transition.speed)switch(e.transition.speed){case"slow":t=100;break;case"medium":t=150;break;case"fast":t=200;break;default:t=150}return I/t}function d(){T=null,R.xpos=0,y.dispatchEvent(new CustomEvent("done",{bubbles:!0}))}function m(){V=document.createElement("canvas"),V.id="secondary",V.style.display="none",C=f(V),document.body.appendChild(V)}function f(t){var i=t.getContext("2d");return t.width=e.width,t.height=e.height,i.xpos=0,i}function h(e){w=e,y=document.getElementById("scroller"),R=f(y),m(),t(),TweenLite.ticker.addEventListener("tick",l),y.dispatchEvent(new CustomEvent("ready",{bubbles:!0}))}function p(e){w=e,O=!1,t()}function g(){T||(T=TweenLite.to(R,u(),{xpos:-I,ease:Linear.easeNone,onComplete:d})),T.play()}function v(){T&&T.pause()}var y=null,R=null,V=null,C=null,T=null,w=[],b=0,I=0,O=!1,L=RiseVision.Common.Utilities,E=32767;return{init:h,play:g,pause:v,refresh:p}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Store=RiseVision.Common.Store||{},RiseVision.Common.Store.Auth={},RiseVision.Common.Store.Auth=function(){function e(e){i=document.createElement("div"),i.className="overlay",document.body.appendChild(i),n=document.createElement("div"),n.className="auth-warning",n.innerHTML=e,n=document.body.appendChild(n)}function t(){i&&n&&(n.parentNode.removeChild(n),i.parentNode.removeChild(i))}var i,n,o=36e5;this.callback=null,this.authorized=!1,this.isAuthorized=function(){return this.authorized},this.checkForDisplay=function(e,t,i){this.callback=i,this.url=WIDGET_COMMON_CONFIG.STORE_URL+WIDGET_COMMON_CONFIG.AUTH_PATH_URL+"?id="+e+"&pc="+t,this.callApi()},this.checkForCompany=function(e,t,i){this.callback=i,this.url=WIDGET_COMMON_CONFIG.STORE_URL+WIDGET_COMMON_CONFIG.AUTH_PATH_URL+"?cid="+e+"&pc="+t,this.callApi()},this.callApi=function(){var e=this;$.ajax({dataType:"json",url:this.url,success:function(t,i){e.onSuccess(t,i)},error:function(){e.onError()}})},this.onSuccess=function(i){if(i&&i.authorized){this.authorized=!0,t();var n=new Date(i.expiry).getTime()-(new Date).getTime()-o;setTimeout(this.callApi,n)}else i&&!i.authorized?(this.authorized=!1,e("Product not authorized."),setTimeout(this.callApi,o)):setTimeout(this.callApi,o);this.callback&&this.callback(this.authorized)},this.onError=function(){this.authorized=!1,e("Cannot connect to Store for authorization."),setTimeout(this.callApi,o),this.callback&&this.callback(this.authorized)}};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Visualization={},RiseVision.Common.Visualization=function(){this.query=null,this.isVisualizationLoaded=!1},RiseVision.Common.Visualization.prototype.getData=function(e){this.url=e.url,this.refreshInterval=e.refreshInterval,this.timeout=e.timeout||30,this.callback=e.callback,this.params=e.params,e.queryString&&(this.queryString=e.queryString),this.isVisualizationLoaded?this.sendQuery():this.loadVisualizationAPI()},RiseVision.Common.Visualization.prototype.loadVisualizationAPI=function(){var e=this;google.load("visualization","1",{callback:function(){e.isVisualizationLoaded=!0,e.sendQuery()}})},RiseVision.Common.Visualization.prototype.sendQuery=function(){var e=this;null!==this.query&&this.query.abort(),this.query=new google.visualization.Query(this.url),this.query.setRefreshInterval(this.refreshInterval),this.query.setTimeout(this.timeout),this.queryString&&this.query.setQuery(this.queryString),this.query.send(function(t){e.onQueryExecuted(t)})},RiseVision.Common.Visualization.prototype.onQueryExecuted=function(e){null===e?this.callback(e,this.params):e.isError()?(console.log("Message: "+e.getMessage()),console.log("Detailed message: "+e.getDetailedMessage()),console.log("Reasons: "+e.getReasons()),this.callback(null,this.params)):this.callback(e.getDataTable(),this.params)};var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.WSClient=function(){function e(e){o(e)}function t(){try{if(top.RiseVision.Viewer.LocalMessaging)return top.RiseVision.Viewer.LocalMessaging.canConnect()}catch(e){console.log("widget-common: ws-client",e)}}function i(){o({topic:"client-list-request"})}function n(e){if(e&&"function"==typeof e)try{top.RiseVision.Viewer.LocalMessaging&&top.RiseVision.Viewer.LocalMessaging.receiveMessages(e)}catch(t){console.log("widget-common: ws-client",t)}}function o(e){try{top.RiseVision.Viewer.LocalMessaging&&top.RiseVision.Viewer.LocalMessaging.write(e)}catch(t){console.log("widget-common: ws-client",t)}}return{broadcastMessage:e,canConnect:t,getModuleClientList:i,receiveMessages:n}}();