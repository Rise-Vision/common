var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(e){"use strict";function t(e,t){Array.isArray(e)&&e.length>0&&Array.isArray(t)&&t.length>0&&("companyId"===e[0]&&(u=t[0]),"displayId"===e[1]&&(g=t[1]?t[1]:"preview"),l(u,g))}function n(n){n&&"function"==typeof n&&(l=n,u&&g?l(u,g):a&&""!==a&&(e.rpc.register("rsparam_set_"+a,t),e.rpc.call("","rsparam_get",null,a,["companyId","displayId"])))}function r(e){return e&&"string"==typeof e?e.substr(e.lastIndexOf("/")+1):""}function s(e){return e&&"string"==typeof e?e.substr(e.lastIndexOf(".")+1).toLowerCase():""}function o(e){var t=JSON.parse(JSON.stringify(c));return t.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),t.rows[0].json=JSON.parse(JSON.stringify(e)),t.rows[0].json.ts=(new Date).toISOString(),t}function i(e){var t=new Date,n=t.getUTCFullYear(),r=t.getUTCMonth()+1,s=t.getUTCDate();return 10>r&&(r="0"+r),10>s&&(s="0"+s),e+n+r+s}var a=(new e.Prefs).getString("id"),g="",u="",l=null,c={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,rows:[{insertId:""}]};return{getIds:n,getInsertData:o,getFileName:r,getFileFormat:s,getTable:i}}(gadgets),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-o<358e4?e({}):(t.open("POST",r,!0),t.onloadend=function(){var n=JSON.parse(t.response);e({token:n.access_token,refreshedAt:new Date})},t.send(),void 0)}function n(n,r){function a(t){var a,g,u=new XMLHttpRequest;g=s.replace("TABLE_ID",e.getTable(n)),o=t.refreshedAt||o,i=t.token||i,a=e.getInsertData(r),u.open("POST",g,!0),u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Authorization","Bearer "+i),r.cb&&"function"==typeof r.cb&&(u.onloadend=function(){r.cb(u.response)}),u.send(JSON.stringify(a))}if(n&&r&&r.event)return t(a)}var r="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",s="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",o=0,i="";return{log:n}}(RiseVision.Common.LoggerUtils);