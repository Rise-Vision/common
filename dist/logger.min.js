var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(){"use strict";function e(e){var t=JSON.parse(JSON.stringify(n));return t.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),t.rows[0].json=JSON.parse(JSON.stringify(e)),t.rows[0].json.ts=(new Date).toISOString(),t}function t(e){var t=new Date,n=t.getUTCFullYear(),s=t.getUTCMonth()+1,o=t.getUTCDate();return 10>s&&(s="0"+s),10>o&&(o="0"+o),e+n+s+o}var n={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,rows:[{insertId:""}]};return{getInsertData:e,getTable:t}}(),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-r<358e4?e({}):(t.open("POST",s,!0),t.onloadend=function(){var n=JSON.parse(t.response);e({token:n.access_token,refreshedAt:new Date})},t.send(),void 0)}function n(n,s){function a(t){var a,u,g=new XMLHttpRequest;u=o.replace("TABLE_ID",e.getTable(n)),r=t.refreshedAt||r,i=t.token||i,a=e.getInsertData(s),g.open("POST",u,!0),g.setRequestHeader("Content-Type","application/json"),g.setRequestHeader("Authorization","Bearer "+i),s.cb&&"function"==typeof s.cb&&(g.onloadend=function(){s.cb(g.response)}),g.send(JSON.stringify(a))}if(n&&s&&s.event)return t(a)}var s="https://www.googleapis.com/oauth2/v3/token?client_id="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_ID+"&client_secret="+WIDGET_COMMON_CONFIG.LOGGER_CLIENT_SECRET+"&refresh_token="+WIDGET_COMMON_CONFIG.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",o="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",r=0,i="";return{log:n}}(RiseVision.Common.LoggerUtils);