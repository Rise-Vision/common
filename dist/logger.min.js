var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.LoggerUtils=function(){"use strict";function e(e,t,s){var o=JSON.parse(JSON.stringify(n));return o.rows[0].insertId=Math.random().toString(36).substr(2).toUpperCase(),o.rows[0].json.event=e,o.rows[0].json.display_id=t,o.rows[0].json.ts=(new Date).toISOString(),s&&(o.rows[0].json.event_details=s),o}function t(e){var t=new Date,n=t.getUTCFullYear(),s=t.getUTCMonth()+1,o=t.getUTCDate();return 10>s&&(s="0"+s),10>o&&(o="0"+o),e+n+s+o}var n={kind:"bigquery#tableDataInsertAllRequest",skipInvalidRows:!1,ignoreUnknownValues:!1,rows:[{insertId:"",json:{event:"",display_id:"",event_details:"",ts:0}}]};return{getInsertData:e,getTable:t}}(),RiseVision.Common.Logger=function(e){"use strict";function t(e){var t=new XMLHttpRequest;return new Date-i<358e4?e({}):(t.open("POST",s,!0),t.onloadend=function(){var n=JSON.parse(t.response);e({token:n.access_token,refreshedAt:new Date})},t.send(),void 0)}function n(n,s,a,g){function u(t){var u,l,c=new XMLHttpRequest;l=o.replace("TABLE_ID",e.getTable("events")),i=t.refreshedAt||i,r=t.token||r,u=e.getInsertData(n,s,a),c.open("POST",l,!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Authorization","Bearer "+r),g&&"function"==typeof g&&(c.onloadend=function(){g(c.response)}),c.send(JSON.stringify(u))}if(n)return t(u)}var s="https://www.googleapis.com/oauth2/v3/token?client_id="+config.LOGGER_CLIENT_ID+"&client_secret="+config.LOGGER_CLIENT_SECRET+"&refresh_token="+config.LOGGER_REFRESH_TOKEN+"&grant_type=refresh_token",o="https://www.googleapis.com/bigquery/v2/projects/client-side-events/datasets/Widget_Events/tables/TABLE_ID/insertAll",i=0,r="";return{log:n}}(RiseVision.Common.LoggerUtils);